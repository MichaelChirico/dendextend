<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find the (estimated) number of clusters for a dendrogram using average silhouette width — find_k • dendextend</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Find the (estimated) number of clusters for a dendrogram using average silhouette width — find_k" />

<meta property="og:description" content="This function estimates the number of clusters based on the maximal average silhouette width
derived from running pam on the cophenetic distance matrix of
the dendrogram. The output is based on the pamk output." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dendextend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.13.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dendextend.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Cluster_Analysis.html">Hierarchical cluster analysis on famous data sets - enhanced with the _dendextend_ package</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/Quick_Introduction.html">Quick Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/talgalili/dendextend">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find the (estimated) number of clusters for a dendrogram using average silhouette width</h1>
    <small class="dont-index">Source: <a href='https://github.com/talgalili/dendextend/blob/master/R/find_k.R'><code>R/find_k.R</code></a></small>
    <div class="hidden name"><code>find_k.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function estimates the number of clusters based on the maximal average <a href='https://rdrr.io/pkg/cluster/man/silhouette.html'>silhouette</a> width
derived from running <a href='https://rdrr.io/pkg/cluster/man/pam.html'>pam</a> on the <a href='https://rdrr.io/r/stats/cophenetic.html'>cophenetic</a> distance matrix of
the <a href='https://rdrr.io/r/stats/dendrogram.html'>dendrogram</a>. The output is based on the <a href='https://rdrr.io/pkg/fpc/man/pamk.html'>pamk</a> output.</p>
    
    </div>

    <pre class="usage"><span class='fu'>find_k</span>(<span class='no'>dend</span>, <span class='kw'>krange</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='fl'>10</span>, (<span class='fu'><a href='nleaves.html'>nleaves</a></span>(<span class='no'>dend</span>) - <span class='fl'>1</span>)), <span class='no'>...</span>)

<span class='co'># S3 method for find_k</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(
  <span class='no'>x</span>,
  <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Number of clusters (k)"</span>,
  <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Average silhouette width"</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Estimating the number of clusters using\n average silhouette width"</span>,
  <span class='no'>...</span>
)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dend</th>
      <td><p>A dendrogram (or hclust) tree object</p></td>
    </tr>
    <tr>
      <th>krange</th>
      <td><p>integer vector. Numbers of clusters which are to be compared
by the average silhouette width criterion.
Note: average silhouette width and Calinski-Harabasz can't estimate number
of clusters nc=1. If 1 is included, a Duda-Hart test is applied and 1 is
estimated if this is not significant.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>passed to <a href='https://rdrr.io/pkg/fpc/man/pamk.html'>pamk</a> (the current defaults criterion="asw" and usepam=TRUE can not be changes).</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>An object of class "find_k" (has its own S3 plot method).</p></td>
    </tr>
    <tr>
      <th>xlab, ylab, main</th>
      <td><p>parameters passed to plot.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <a href='https://rdrr.io/pkg/fpc/man/pamk.html'>pamk</a> output. This is a list with the following components:
1) pamobject - The output of the optimal run of the pam-function.
2) nc	- the optimal number of clusters.
3) crit - vector of criterion values for numbers of clusters. crit[1] is the p-value of the Duda-Hart test if 1 is in krange and diss=FALSE.
4) k - a copy of nc (just to make it easier to extract - since k is often used in other functions)</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='https://rdrr.io/pkg/fpc/man/pamk.html'>pamk</a>, <a href='https://rdrr.io/pkg/cluster/man/pam.html'>pam</a>, <a href='https://rdrr.io/pkg/cluster/man/silhouette.html'>silhouette</a>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>dend</span> <span class='kw'>&lt;-</span> <span class='no'>iris</span>[, -<span class='fl'>5</span>] <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>()
<span class='no'>dend_k</span> <span class='kw'>&lt;-</span> <span class='fu'>find_k</span>(<span class='no'>dend</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>dend_k</span>)</div><div class='img'><img src='find_k-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='color_branches.html'>color_branches</a></span>(<span class='no'>dend</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>dend_k</span>$<span class='no'>nc</span>))</div><div class='img'><img src='find_k-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>cluster</span>)
<span class='no'>sil</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/cluster/man/silhouette.html'>silhouette</a></span>(<span class='no'>dend_k</span>$<span class='no'>pamobject</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>sil</span>)</div><div class='img'><img src='find_k-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>dend</span> <span class='kw'>&lt;-</span> <span class='no'>USArrests</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>(<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"ave"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>()
<span class='no'>dend_k</span> <span class='kw'>&lt;-</span> <span class='fu'>find_k</span>(<span class='no'>dend</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>dend_k</span>)</div><div class='img'><img src='find_k-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='color_branches.html'>color_branches</a></span>(<span class='no'>dend</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>dend_k</span>$<span class='no'>nc</span>))</div><div class='img'><img src='find_k-5.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tal Galili, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


