<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Stepwise untangle one tree compared to another — untangle_step_rotate_1side • dendextend</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Stepwise untangle one tree compared to another — untangle_step_rotate_1side" />

<meta property="og:description" content="Given a fixed tree and a tree we wish to rotate, this function goes
through all of the k number of clusters (from 2 onward), and each time
rotates the branch which was introduced in the new k'th cluster.
This rotated tree is compared with the fixed tree, and if it has a better
entanglement, it will be used for the following iterations.
This is a greedy forward selection algorithm for rotating the tree and
looking for a better match.
This is useful for finding good trees for a tanglegram." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dendextend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.13.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dendextend.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Cluster_Analysis.html">Hierarchical cluster analysis on famous data sets - enhanced with the _dendextend_ package</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/Quick_Introduction.html">Quick Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/talgalili/dendextend">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stepwise untangle one tree compared to another</h1>
    <small class="dont-index">Source: <a href='https://github.com/talgalili/dendextend/blob/master/R/untangle.R'><code>R/untangle.R</code></a></small>
    <div class="hidden name"><code>untangle_step_rotate_1side.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Given a fixed tree and a tree we wish to rotate, this function goes
through all of the k number of clusters (from 2 onward), and each time
rotates the branch which was introduced in the new k'th cluster.
This rotated tree is compared with the fixed tree, and if it has a better
entanglement, it will be used for the following iterations.</p>
<p>This is a greedy forward selection algorithm for rotating the tree and
looking for a better match.</p>
<p>This is useful for finding good trees for a <a href='tanglegram.html'>tanglegram</a>.</p>
    
    </div>

    <pre class="usage"><span class='fu'>untangle_step_rotate_1side</span>(
  <span class='no'>dend1</span>,
  <span class='no'>dend2_fixed</span>,
  <span class='kw'>L</span> <span class='kw'>=</span> <span class='fl'>1.5</span>,
  <span class='kw'>direction</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"forward"</span>, <span class='st'>"backward"</span>),
  <span class='kw'>k_seq</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>dend_heights_per_k</span>,
  <span class='kw'>leaves_matching_method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"labels"</span>, <span class='st'>"order"</span>),
  <span class='no'>...</span>
)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dend1</th>
      <td><p>a dendrogram object. The one we will rotate to best fit
dend2_fixed.</p></td>
    </tr>
    <tr>
      <th>dend2_fixed</th>
      <td><p>a dendrogram object. This one is kept fixed.</p></td>
    </tr>
    <tr>
      <th>L</th>
      <td><p>the distance norm to use for measuring the distance between the
two trees. It can be any positive number,
often one will want to use 0, 1, 1.5, 2 (see 'details' in <a href='entanglement.html'>entanglement</a>).</p></td>
    </tr>
    <tr>
      <th>direction</th>
      <td><p>a character scalar, either "forward" (default) or "backward".
Impacts the direction of clustering that are tried. Either from 2 and up
(in case of "forward"), or from nleaves to down (in case of "backward")</p>
<p>If k_seq is not NULL, then it overrides "direction".</p></td>
    </tr>
    <tr>
      <th>k_seq</th>
      <td><p>a sequence of k clusters to go through for improving
dend1. If NULL (default), then we use the "direction" parameter.</p></td>
    </tr>
    <tr>
      <th>dend_heights_per_k</th>
      <td><p>a numeric vector of values which indicate which height will produce which number of clusters (k)</p></td>
    </tr>
    <tr>
      <th>leaves_matching_method</th>
      <td><p>a character scalar passed to <a href='entanglement.html'>entanglement</a>.
It can be either "order" or "labels" (default). If using "labels",
then we use the labels for matching the leaves order value.
And if "order" then we use the old leaves order value for matching the
leaves order value.</p>
<p>Using "order" is faster, but "labels" is safer. "order" will assume that
the original two trees had their labels and order values MATCHED.</p>
<p>Hence, it is best to make sure that the trees used here have the same labels
and the SAME values matched to these values - and then use "order" (for
fastest results).</p>
<p>If "order" is used, the function first calls <a href='match_order_by_labels.html'>match_order_by_labels</a>
in order to make sure that the two trees have their labels synced with
their leaves order values.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>not used</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A dendlist with
1) dend1 after it was rotated to best fit dend2_fixed.
2) dend2_fixed.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='tanglegram.html'>tanglegram</a>, <a href='match_order_by_labels.html'>match_order_by_labels</a>,
<a href='entanglement.html'>entanglement</a>, <a href='flip_leaves.html'>flip_leaves</a>, <a href='all_couple_rotations_at_k.html'>all_couple_rotations_at_k</a>,
<a href='untangle_step_rotate_2side.html'>untangle_step_rotate_2side</a>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>dend1</span> <span class='kw'>&lt;-</span> <span class='no'>USArrests</span>[<span class='fl'>1</span>:<span class='fl'>10</span>, ] <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>()
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>3525</span>)
<span class='no'>dend2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='shuffle.html'>shuffle</a></span>(<span class='no'>dend1</span>)
<span class='fu'><a href='tanglegram.html'>tanglegram</a></span>(<span class='no'>dend1</span>, <span class='no'>dend2</span>)
<span class='fu'><a href='entanglement.html'>entanglement</a></span>(<span class='no'>dend1</span>, <span class='no'>dend2</span>, <span class='kw'>L</span> <span class='kw'>=</span> <span class='fl'>2</span>) <span class='co'># 0.4727</span>

<span class='no'>dend2_corrected</span> <span class='kw'>&lt;-</span> <span class='fu'>untangle_step_rotate_1side</span>(<span class='no'>dend2</span>, <span class='no'>dend1</span>)<span class='kw'>[[</span><span class='fl'>1</span>]]
<span class='fu'><a href='tanglegram.html'>tanglegram</a></span>(<span class='no'>dend1</span>, <span class='no'>dend2_corrected</span>) <span class='co'># FIXED.</span>
<span class='fu'><a href='entanglement.html'>entanglement</a></span>(<span class='no'>dend1</span>, <span class='no'>dend2_corrected</span>, <span class='kw'>L</span> <span class='kw'>=</span> <span class='fl'>2</span>) <span class='co'># 0</span>
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tal Galili, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


