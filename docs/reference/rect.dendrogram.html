<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Draw Rectangles Around a Dendrogram's Clusters — rect.dendrogram • dendextend</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Draw Rectangles Around a Dendrogram's Clusters — rect.dendrogram" />

<meta property="og:description" content="Draws rectangles around the branches of a dendrogram
 highlighting the corresponding clusters.
 First the dendrogram is cut at a certain level,
 then a rectangle is drawn around selected branches." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dendextend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.13.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dendextend.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Cluster_Analysis.html">Hierarchical cluster analysis on famous data sets - enhanced with the _dendextend_ package</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/Quick_Introduction.html">Quick Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/talgalili/dendextend">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Draw Rectangles Around a Dendrogram's Clusters</h1>
    <small class="dont-index">Source: <a href='https://github.com/talgalili/dendextend/blob/master/R/rect.dendrogram.R'><code>R/rect.dendrogram.R</code></a></small>
    <div class="hidden name"><code>rect.dendrogram.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Draws rectangles around the branches of a dendrogram
 highlighting the corresponding clusters.
 First the dendrogram is cut at a certain level,
 then a rectangle is drawn around selected branches.</p>
    
    </div>

    <pre class="usage"><span class='fu'>rect.dendrogram</span>(
  <span class='no'>tree</span>,
  <span class='kw'>k</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>which</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>x</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>h</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>border</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>cluster</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>horiz</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>density</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>angle</span> <span class='kw'>=</span> <span class='fl'>45</span>,
  <span class='kw'>text</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>text_cex</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>text_col</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>xpd</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>lower_rect</span>,
  <span class='kw'>upper_rect</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>prop_k_height</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>stop_if_out</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>...</span>
)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tree</th>
      <td><p>a <a href='https://rdrr.io/r/stats/dendrogram.html'>dendrogram</a> object.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>Scalar. Cut the dendrogram such that exactly k clusters (if possible) are produced.</p></td>
    </tr>
    <tr>
      <th>which</th>
      <td><p>A vector selecting the clusters around
which a rectangle should be drawn. which selects clusters by number
 (from left to right in the tree), Default is which = 1:k.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A vector selecting the clusters around
which a rectangle should be drawn. x selects clusters
 containing the respective horizontal coordinates.</p></td>
    </tr>
    <tr>
      <th>h</th>
      <td><p>Scalar. Cut the dendrogram by cutting at height h. (k overrides h)</p></td>
    </tr>
    <tr>
      <th>border</th>
      <td><p>Vector with border colors for the rectangles.</p></td>
    </tr>
    <tr>
      <th>cluster</th>
      <td><p>Optional vector with cluster memberships as returned by
cutree(dend_obj, k = k), can be specified for efficiency if already computed.</p></td>
    </tr>
    <tr>
      <th>horiz</th>
      <td><p>logical (FALSE), indicating if the rectangles
should be drawn horizontally or not (for when using
plot(dend, horiz = TRUE) ) .</p></td>
    </tr>
    <tr>
      <th>density</th>
      <td><p>Passed to <a href='https://rdrr.io/r/graphics/rect.html'>rect</a>: the density of shading lines,
in lines per inch. The default value of NULL means that
no shading lines are drawn. A zero value of density means
no shading lines whereas negative values (and NA)
suppress shading (and so allow color filling).
If border is a vector of colors, the color of density will default to 1.</p></td>
    </tr>
    <tr>
      <th>angle</th>
      <td><p>Passed to <a href='https://rdrr.io/r/graphics/rect.html'>rect</a>: angle (in degrees) of the shading lines.
(default is 45)</p></td>
    </tr>
    <tr>
      <th>text</th>
      <td><p>a character vector of labels to plot underneath the clusters.
When NULL (default), no text is displayed.</p></td>
    </tr>
    <tr>
      <th>text_cex</th>
      <td><p>a numeric (scalar) value of the text's cex value.</p></td>
    </tr>
    <tr>
      <th>text_col</th>
      <td><p>a (scalar) value of the text's col(or) value.</p></td>
    </tr>
    <tr>
      <th>xpd</th>
      <td><p>A logical value (or NA.), passed to <a href='https://rdrr.io/r/graphics/par.html'>par</a>.
Default is TRUE, in order to allow the rect to be below the labels.
If FALSE, all plotting is clipped to the plot region, if TRUE,
all plotting is clipped to the figure region, and if NA, all plotting
is clipped to the device region. See also <a href='https://rdrr.io/r/graphics/clip.html'>clip</a>.</p></td>
    </tr>
    <tr>
      <th>lower_rect</th>
      <td><p>a (scalar) value of how low should the lower part of the rect be.
If missing, it will take the value of par("usr")[3L] (or par("usr")[2L], depending
if horiz = TRUE or not), with also the width of the labels. (notice that we
would like to keep xpd = TRUE if we want the rect to be after the labels!)
You can use a value such as 0, to get the rect above the labels.</p>
<p>Notice that for a plot with small margins, it would be better to set this
parameter manually.</p></td>
    </tr>
    <tr>
      <th>upper_rect</th>
      <td><p>a (scalar) value to add (default is 0) to how high should the upper part of the rect be.</p></td>
    </tr>
    <tr>
      <th>prop_k_height</th>
      <td><p>a (scalar) value (should be between 0 to 1), indicating what proportion
of the height our rect will be between the height needed for k and k+1 clustering.</p></td>
    </tr>
    <tr>
      <th>stop_if_out</th>
      <td><p>logical (default is TRUE). This makes the function
stop if k of the locator is outside the range (this default reproduces the behavior
of the rect.hclust function).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>parameters passed to rect (such as lwd, lty, etc.)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>This function is based on <a href='https://rdrr.io/r/stats/rect.hclust.html'>rect.hclust</a>, with slight modifications
to have it work with a dendrogram, as well as a few added features
(e.g: ... to rect, and horiz)</p>
<p>The idea of adding text and shading lines under the clusters comes from
skullkey from here:
<a href='http://stackoverflow.com/questions/4720307/change-dendrogram-leaves'>http://stackoverflow.com/questions/4720307/change-dendrogram-leaves</a></p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>(Invisibly) returns a list where each element contains a vector
 of data points contained in the respective cluster.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='https://rdrr.io/r/stats/rect.hclust.html'>rect.hclust</a>, <a href='https://rdrr.io/r/stats/order.dendrogram.html'>order.dendrogram</a>, <a href='cutree-methods.html'>cutree.dendrogram</a></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>23235</span>)
<span class='no'>ss</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>1</span>:<span class='fl'>150</span>, <span class='fl'>10</span>)
<span class='no'>hc</span> <span class='kw'>&lt;-</span> <span class='no'>iris</span>[<span class='no'>ss</span>, -<span class='fl'>5</span>] <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>()
<span class='no'>dend</span> <span class='kw'>&lt;-</span> <span class='no'>hc</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>()

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>dend</span>)</div><div class='input'><span class='fu'>rect.dendrogram</span>(<span class='no'>dend</span>, <span class='fl'>2</span>, <span class='kw'>border</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='input'><span class='fu'>rect.dendrogram</span>(<span class='no'>dend</span>, <span class='fl'>3</span>, <span class='kw'>border</span> <span class='kw'>=</span> <span class='fl'>4</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Vectorize.html'>Vectorize</a></span>(<span class='no'>rect.dendrogram</span>, <span class='st'>"k"</span>)(<span class='no'>dend</span>, <span class='fl'>4</span>:<span class='fl'>5</span>, <span class='kw'>border</span> <span class='kw'>=</span> <span class='fl'>6</span>)</div><div class='img'><img src='rect.dendrogram-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; [[1]]
#&gt; [[1]][[1]]
#&gt; 123 
#&gt;   7 
#&gt; 
#&gt; [[1]][[2]]
#&gt; 111 145 
#&gt;   4   8 
#&gt; 
#&gt; [[1]][[3]]
#&gt; 29 17 25 
#&gt;  1  3  9 
#&gt; 
#&gt; [[1]][[4]]
#&gt; 85 80 88 74 
#&gt;  2  5  6 10 
#&gt; 
#&gt; 
#&gt; [[2]]
#&gt; [[2]][[1]]
#&gt; 123 
#&gt;   7 
#&gt; 
#&gt; [[2]][[2]]
#&gt; 111 145 
#&gt;   4   8 
#&gt; 
#&gt; [[2]][[3]]
#&gt; 29 17 25 
#&gt;  1  3  9 
#&gt; 
#&gt; [[2]][[4]]
#&gt; 80 
#&gt;  5 
#&gt; 
#&gt; [[2]][[5]]
#&gt; 85 88 74 
#&gt;  2  6 10 
#&gt; 
#&gt; </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>dend</span>)</div><div class='input'><span class='fu'>rect.dendrogram</span>(<span class='no'>dend</span>, <span class='fl'>3</span>,
  <span class='kw'>border</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>3</span>,
  <span class='kw'>density</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>text</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"1"</span>, <span class='st'>"b"</span>, <span class='st'>"miao"</span>), <span class='kw'>text_cex</span> <span class='kw'>=</span> <span class='fl'>3</span>
)</div><div class='img'><img src='rect.dendrogram-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>dend</span>)</div><div class='input'><span class='fu'>rect.dendrogram</span>(<span class='no'>dend</span>, <span class='fl'>4</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>3</span>), <span class='kw'>border</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>3</span>))</div><div class='input'><span class='fu'>rect.dendrogram</span>(<span class='no'>dend</span>, <span class='fl'>4</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>border</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>))</div><div class='input'><span class='fu'>rect.dendrogram</span>(<span class='no'>dend</span>, <span class='fl'>3</span>, <span class='kw'>border</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='img'><img src='rect.dendrogram-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># now THIS, you can not do with the old rect.hclust</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>dend</span>, <span class='kw'>horiz</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='input'><span class='fu'>rect.dendrogram</span>(<span class='no'>dend</span>, <span class='fl'>2</span>, <span class='kw'>border</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>horiz</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='input'><span class='fu'>rect.dendrogram</span>(<span class='no'>dend</span>, <span class='fl'>4</span>, <span class='kw'>border</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>horiz</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='img'><img src='rect.dendrogram-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># This had previously failed since it worked with a wrong k.</span>

<span class='no'>dend15</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>:<span class='fl'>5</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>(<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"average"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>()
<span class='co'># dend15 &lt;- c(1:25) %&gt;% dist %&gt;% hclust(method = "average") %&gt;% as.dendrogram</span>
<span class='no'>dend15</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='set.html'>set</a></span>(<span class='st'>"branches_k_color"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>()</div><div class='input'><span class='no'>dend15</span> <span class='kw'>%&gt;%</span> <span class='fu'>rect.dendrogram</span>(
  <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>,
  <span class='kw'>border</span> <span class='kw'>=</span> <span class='fl'>8</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>
)</div><div class='img'><img src='rect.dendrogram-5.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#source">Source</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tal Galili, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


