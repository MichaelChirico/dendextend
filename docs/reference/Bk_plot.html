<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bk plot - ploting the Fowlkes-Mallows Index of two dendrogram for various k's — Bk_plot • dendextend</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Bk plot - ploting the Fowlkes-Mallows Index of two dendrogram for various k's — Bk_plot" />

<meta property="og:description" content="Bk is the calculation of Fowlkes-Mallows index for a series of k cuts
for two dendrograms.
A Bk plot is simply a scatter plot of Bk versus k.
This plot helps in identifiying the similarity between two dendrograms in
different levels of k (number of clusters)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dendextend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.13.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dendextend.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Cluster_Analysis.html">Hierarchical cluster analysis on famous data sets - enhanced with the _dendextend_ package</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/Quick_Introduction.html">Quick Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/talgalili/dendextend">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bk plot - ploting the Fowlkes-Mallows Index of two dendrogram for various k's</h1>
    <small class="dont-index">Source: <a href='https://github.com/talgalili/dendextend/blob/master/R/bk_method.R'><code>R/bk_method.R</code></a></small>
    <div class="hidden name"><code>Bk_plot.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Bk is the calculation of Fowlkes-Mallows index for a series of k cuts
for two dendrograms.
A Bk plot is simply a scatter plot of Bk versus k.
This plot helps in identifiying the similarity between two dendrograms in
different levels of k (number of clusters).</p>
    
    </div>

    <pre class="usage"><span class='fu'>Bk_plot</span>(
  <span class='no'>tree1</span>,
  <span class='no'>tree2</span>,
  <span class='no'>k</span>,
  <span class='kw'>add_E</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>rejection_line_asymptotic</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>rejection_line_permutation</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>R</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='no'>k_permutation</span>,
  <span class='kw'>conf.level</span> <span class='kw'>=</span> <span class='fl'>0.95</span>,
  <span class='kw'>p.adjust.methods</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"none"</span>, <span class='st'>"bonferroni"</span>),
  <span class='kw'>col_line_Bk</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>col_line_asymptotic</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>col_line_permutation</span> <span class='kw'>=</span> <span class='fl'>4</span>,
  <span class='kw'>warn</span> <span class='kw'>=</span> <span class='fu'><a href='dendextend_options.html'>dendextend_options</a></span>(<span class='st'>"warn"</span>),
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Bk plot"</span>,
  <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"k (number of clusters)"</span>,
  <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Bk (Fowlkes-Mallows Index)"</span>,
  <span class='no'>xlim</span>,
  <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>),
  <span class='kw'>try_cutree_hclust</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>
)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tree1</th>
      <td><p>a dendrogram/hclust/phylo object.</p></td>
    </tr>
    <tr>
      <th>tree2</th>
      <td><p>a dendrogram/hclust/phylo object.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>an integer scalar or vector with the desired number
of cluster groups.
If missing - the Bk will be calculated for a default k range of
2:(nleaves-1).
No point in checking k=1/k=n, since both will give Bk=1.</p></td>
    </tr>
    <tr>
      <th>add_E</th>
      <td><p>logical (TRUE). Should we add a line of the Expected Bk value
for each k, under the null hypothesis of no relation between the clusterings?</p></td>
    </tr>
    <tr>
      <th>rejection_line_asymptotic</th>
      <td><p>logical (TRUE). Should we add a line of
the one sided rejection region based on the asymptotic distribution
of Bk values, for each k, under the null hypothesis of no relation
between the clusterings?</p></td>
    </tr>
    <tr>
      <th>rejection_line_permutation</th>
      <td><p>logical (FALSE). Should we add a line of
the one sided rejection region based on the asymptotic distribution
of Bk values, for each k, under the null hypothesis of no relation
between the clusterings?</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>integer (Default is 1000). The number of Bk permutation to perform
for each k. Applicable only if rejection_line_permutation is TRUE.</p></td>
    </tr>
    <tr>
      <th>k_permutation</th>
      <td><p>the k's to be used for permutation (sometimes we might
be only interested in some k's and it is not important to run the simulation
for all possible ks). If missing - k itself will be used.</p></td>
    </tr>
    <tr>
      <th>conf.level</th>
      <td><p>the level of one sided confidence interval used for creation
of the rejection lines.</p></td>
    </tr>
    <tr>
      <th>p.adjust.methods</th>
      <td><p>a character scalar of either "none" (default), or
"bonferroni". This controls the multiple correction method to use for the
critical rejection values. Currently only the Bonferroni method
is implemented (based on the number of different k values).</p></td>
    </tr>
    <tr>
      <th>col_line_Bk</th>
      <td><p>the color of the Bk line.</p></td>
    </tr>
    <tr>
      <th>col_line_asymptotic</th>
      <td><p>the color of the rejection asymptotic Bk line.</p></td>
    </tr>
    <tr>
      <th>col_line_permutation</th>
      <td><p>the color of the rejection asymptotic Bk line.</p></td>
    </tr>
    <tr>
      <th>warn</th>
      <td><p>logical (default from dendextend_options("warn") is FALSE).
Set if warning are to be issued, it is safer to keep this at TRUE,
but for keeping the noise down, the default is FALSE.
If set to TRUE, extra checks are made to varify that the two clusters have
the same size and the same labels.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>passed to <a href='https://rdrr.io/r/graphics/plot.html'>plot</a>.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>passed to <a href='https://rdrr.io/r/graphics/plot.html'>plot</a>.</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>passed to <a href='https://rdrr.io/r/graphics/plot.html'>plot</a>.</p></td>
    </tr>
    <tr>
      <th>xlim</th>
      <td><p>passed to <a href='https://rdrr.io/r/graphics/plot.html'>plot</a>. If missign, xlim is from 2 to nleaves-1</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>passed to <a href='https://rdrr.io/r/graphics/plot.html'>plot</a>.</p></td>
    </tr>
    <tr>
      <th>try_cutree_hclust</th>
      <td><p>logical (TRUE). Since cutree for hclust is MUCH
faster than for dendrogram - Bk_plot will first try to change the dendrogram
into an hclust object. If it will fail (for example, with unbranched trees),
it will continue using the cutree.dendrogram functions.
If try_cutree_hclust=FALSE, it will force to use cutree.dendrogram and
not cutree.hclust.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Ignored.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>After plotting the Bk plot.
Returns (invisible) the output of the elements used for constructing the plot:
The Bk values, Bk permutations (if used), Bk theoratical values, etc.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>From Wikipedia:</p>
<p>Fowlkes-Mallows index (see references) is an external evaluation method
that is used to determine the similarity between two clusterings
(clusters obtained after a clustering algorithm). This measure of similarity
could be either between two hierarchical clusterings or a clustering and
a benchmark classification. A higher the value for the Fowlkes-Mallows index
indicates a greater similarity between the clusters and the benchmark
classifications.</p>
<p>The default Bk plot comes with a line with dots (type "b") of the Bk values.
Also with a fragmented (lty=2) line (of the same color) of the expected Bk
line under H0,
And a solid red line of the upper critical Bk values for rejection</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Fowlkes, E. B.; Mallows, C. L. (1 September 1983).
"A Method for Comparing Two Hierarchical Clusterings".
Journal of the American Statistical Association 78 (383): 553.</p>
<p><a href='http://en.wikipedia.org/wiki/Fowlkes-Mallows_index'>http://en.wikipedia.org/wiki/Fowlkes-Mallows_index</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='FM_index.html'>FM_index</a></code>, <a href='Bk.html'>Bk</a>, <a href='Bk_permutations.html'>Bk_permutations</a></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>23235</span>)
<span class='no'>ss</span> <span class='kw'>&lt;-</span> <span class='fl'>TRUE</span> <span class='co'># sample(1:150, 10 )</span>
<span class='no'>hc1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>(<span class='no'>iris</span>[<span class='no'>ss</span>, -<span class='fl'>5</span>]), <span class='st'>"com"</span>)
<span class='no'>hc2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>(<span class='no'>iris</span>[<span class='no'>ss</span>, -<span class='fl'>5</span>]), <span class='st'>"single"</span>)
<span class='co'># tree1 &lt;- as.treerogram(hc1)</span>
<span class='co'># tree2 &lt;- as.treerogram(hc2)</span>
<span class='co'>#    cutree(tree1)</span>

<span class='fu'>Bk_plot</span>(<span class='no'>hc1</span>, <span class='no'>hc2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>20</span>, <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>149</span>))
<span class='fu'>Bk_plot</span>(<span class='no'>hc1</span>, <span class='no'>hc2</span>)

<span class='fu'>Bk_plot</span>(<span class='no'>hc1</span>, <span class='no'>hc2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'>Bk_plot</span>(<span class='no'>hc1</span>, <span class='no'>hc2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>:<span class='fl'>10</span>)
<span class='fu'>Bk_plot</span>(<span class='no'>hc1</span>, <span class='no'>hc2</span>)
<span class='fu'>Bk_plot</span>(<span class='no'>hc1</span>, <span class='no'>hc2</span>, <span class='kw'>p.adjust.methods</span> <span class='kw'>=</span> <span class='st'>"bonferroni"</span>) <span class='co'># higher rejection lines</span>

<span class='co'># this one can take a bit of time:</span>
<span class='fu'>Bk_plot</span>(<span class='no'>hc1</span>, <span class='no'>hc2</span>,
  <span class='kw'>rejection_line_permutation</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>k_permutation</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>6</span>, <span class='fl'>8</span>, <span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>30</span>, <span class='fl'>40</span>, <span class='fl'>50</span>), <span class='kw'>R</span> <span class='kw'>=</span> <span class='fl'>100</span>
)
<span class='co'># we can see that the permutation line is VERY close to the asymptotic line.</span>
<span class='co'># This is great since it means one can often use the asymptotic results</span>
<span class='co'># Without having to do many simulations.</span>

<span class='co'># works just as well for dendrograms:</span>
<span class='no'>dend1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>(<span class='no'>hc1</span>)
<span class='no'>dend2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>(<span class='no'>hc2</span>)
<span class='fu'>Bk_plot</span>(<span class='no'>dend1</span>, <span class='no'>dend2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>3</span>, <span class='kw'>try_cutree_hclust</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>) <span class='co'># slower than hclust, but works...</span>
<span class='fu'>Bk_plot</span>(<span class='no'>hc1</span>, <span class='no'>dend2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>3</span>, <span class='kw'>try_cutree_hclust</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>) <span class='co'># slower than hclust, but works...</span>
<span class='fu'>Bk_plot</span>(<span class='no'>dend1</span>, <span class='no'>dend1</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>3</span>, <span class='kw'>try_cutree_hclust</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='co'># slower than hclust, but works...</span>
<span class='fu'>Bk_plot</span>(<span class='no'>hc1</span>, <span class='no'>hc1</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>3</span>) <span class='co'># slower than hclust, but works...</span>
<span class='co'># for some reason it can't turn dend2 back to hclust :(</span>
<span class='no'>a</span> <span class='kw'>&lt;-</span> <span class='fu'>Bk_plot</span>(<span class='no'>hc1</span>, <span class='no'>hc2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>3</span>, <span class='kw'>try_cutree_hclust</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='co'># slower than hclust, but works...</span>

<span class='no'>hc1_mixed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/as.hclust.html'>as.hclust</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>(<span class='no'>hc1</span>)))
<span class='fu'>Bk_plot</span>(
  <span class='kw'>tree1</span> <span class='kw'>=</span> <span class='no'>hc1</span>, <span class='kw'>tree2</span> <span class='kw'>=</span> <span class='no'>hc1_mixed</span>,
  <span class='kw'>add_E</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>rejection_line_permutation</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>k_permutation</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>6</span>, <span class='fl'>8</span>, <span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>30</span>, <span class='fl'>40</span>, <span class='fl'>50</span>), <span class='kw'>R</span> <span class='kw'>=</span> <span class='fl'>100</span>
)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tal Galili, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


