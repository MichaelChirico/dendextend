<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Rotate a tree object — rotate • dendextend</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Rotate a tree object — rotate" />

<meta property="og:description" content="Rotates, rev and sort the branches of a tree object (dendrogram, hclust)
based on a vector - eithor of labels order (numbers) or the labels in their
new order (character)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dendextend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.13.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dendextend.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Cluster_Analysis.html">Hierarchical cluster analysis on famous data sets - enhanced with the _dendextend_ package</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/Quick_Introduction.html">Quick Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/talgalili/dendextend">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rotate a tree object</h1>
    <small class="dont-index">Source: <a href='https://github.com/talgalili/dendextend/blob/master/R/rotate.R'><code>R/rotate.R</code></a></small>
    <div class="hidden name"><code>rotate.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Rotates, rev and sort the branches of a tree object (dendrogram, hclust)
based on a vector - eithor of labels order (numbers) or the labels in their
new order (character).</p>
    
    </div>

    <pre class="usage"><span class='fu'>rotate</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>rotate</span>(<span class='no'>x</span>, <span class='no'>order</span>, <span class='no'>...</span>)

<span class='co'># S3 method for dendrogram</span>
<span class='fu'>rotate</span>(<span class='no'>x</span>, <span class='no'>order</span>, <span class='no'>...</span>)

<span class='co'># S3 method for hclust</span>
<span class='fu'>rotate</span>(<span class='no'>x</span>, <span class='no'>order</span>, <span class='no'>...</span>)

<span class='co'># S3 method for phylo</span>
<span class='fu'>rotate</span>(<span class='no'>x</span>, <span class='no'>...</span>, <span class='no'>phy</span>)

<span class='co'># S3 method for dendrogram</span>
<span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>(<span class='no'>x</span>, <span class='kw'>decreasing</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"labels"</span>, <span class='st'>"nodes"</span>), <span class='no'>...</span>)

<span class='co'># S3 method for hclust</span>
<span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>(<span class='no'>x</span>, <span class='kw'>decreasing</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for dendlist</span>
<span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for hclust</span>
<span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a tree object (either a <code>dendrogram</code> or <code>hclust</code>)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>parameters passed (for example, in case of sort)</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>Either numeric or character vector.
Is numeric: it is a numeric vector with the order of the value to be
assigned to object's label. The numbers say are just like when you use <a href='https://rdrr.io/r/base/order.html'>order</a>:
which of the items on the tree-plot should be "first" (e.g: most left),
second etc. (this is relevant only to <code>rotate</code>)
Is character: it must be a vector with the content of labels(x), in the
order we'd like to have the new tree.</p></td>
    </tr>
    <tr>
      <th>phy</th>
      <td><p>a placeholder in case the user uses "phy ="</p></td>
    </tr>
    <tr>
      <th>decreasing</th>
      <td><p>logical. Should the sort be increasing or decreasing? Not available for partial sorting. (relevant only to <code>sort</code>)</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>a character indicating how to sort. If "labels" then by lexicographic
order of the labels. If "nodes", then by using <a href='ladderize.html'>ladderize</a> (order so that
recursively, the leftmost branch will be the smallest)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A rotated tree object</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The motivation for this function came from the function
<code><a href='https://rdrr.io/r/stats/order.dendrogram.html'>order.dendrogram</a></code> NOT being very intuitive.
What <code>rotate</code> aims to do is give a simple tree rotation function which
is based on the order which the user would like to see the tree rotated by
(just as <code><a href='https://rdrr.io/r/base/order.html'>order</a></code> works for numeric vectors).</p>
<p><code><a href='https://rdrr.io/r/stats/dendrogram.html'>rev.dendrogram</a></code> is part of base R, and returns the tree object
after rotating it so that the order of the labels is reversed.
Here we added an S3 method for hclust objects.</p>
<p>The <code>sort</code> methods sort the labels of the tree (using <code>order</code>)
and then attempts to rotate the tree to fit that order.</p>
<p>The hclust method of "<code>rotate</code>" works by first changing the object into
dendrogram, performing the rotation, and then changing it back to hclust.
Special care is taken in preserving some of the properties of the hclust
object.</p>
<p>The ape package has its own <code><a href='https://rdrr.io/pkg/ape/man/rotate.html'>rotate</a></code>(ape) function
(Which is sadly not S3, so cannot be easily connected with the
current implementation).  Still, there is an S3 plug that makes sure people
loading first ape and then dendextend will still be able to
use <code>rotate</code> without a problem.
Notice that if you will first load ape and only then dendextend,
using "rotate" will fail with the error: "Error in rotate(dend, ____) :
 object "phy" is not of class "phylo"" - this is because rotate in ape
 is not S3 and will fail to find the rotate.dendrogram function.
 In such a case simply run <code><a href='https://rdrr.io/r/base/ns-load.html'>unloadNamespace(ape)</a></code>. Or, you can run:
 <code><a href='https://rdrr.io/r/base/ns-load.html'>unloadNamespace("dendextend"); attachNamespace("dendextend")</a></code>
 The solution for this is that if you have ape installed on your machine,
 It will be loaded when you load dendextend (but after it).
 This way, <code>rotate</code> will work fine for both dendrogram AND phylo
 objects.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/order.dendrogram.html'>order.dendrogram</a></code>,  <code><a href='https://rdrr.io/r/base/order.html'>order</a></code>,
<code><a href='https://rdrr.io/r/stats/dendrogram.html'>rev.dendrogram</a></code>, <code><a href='https://rdrr.io/pkg/ape/man/rotate.html'>rotate</a></code> (ape), <a href='ladderize.html'>ladderize</a></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>hc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>(<span class='no'>USArrests</span>[<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>6</span>, <span class='fl'>13</span>, <span class='fl'>20</span>, <span class='fl'>23</span>), ]), <span class='st'>"ave"</span>)
<span class='no'>dend</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>(<span class='no'>hc</span>)

<span class='co'># For dendrogram objects:</span>
<span class='fu'><a href='labels_colors.html'>labels_colors</a></span>(<span class='no'>dend</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>rainbow</a></span>(<span class='fu'><a href='nleaves.html'>nleaves</a></span>(<span class='no'>dend</span>))
<span class='co'># let's color the labels to make the followup of the rotation easier</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>dend</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Original tree"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'>rotate</span>(<span class='no'>dend</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>:<span class='fl'>5</span>, <span class='fl'>1</span>)),
  <span class='kw'>main</span> <span class='kw'>=</span>
    <span class='st'>"Rotates the left most leaf \n into the right side of the tree"</span>
)</div><div class='output co'>#&gt; <span class='error'>Error in rotate(dend, c(2:5, 1)): object "phy" is not of class "phylo"</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>))</div><div class='img'><img src='rotate-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>dend</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Original tree"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>(<span class='no'>dend</span>), <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Sorts the labels by alphabetical order \n
and rotates the tree to give the best fit possible"</span>)</div><div class='img'><img src='rotate-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>dend</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Original tree"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span>(<span class='no'>dend</span>), <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Reverses the order of the tree labels"</span>)</div><div class='img'><img src='rotate-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># For hclust objects:</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>hc</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'>rotate</span>(<span class='no'>hc</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>:<span class='fl'>5</span>, <span class='fl'>1</span>)), <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Rotates the left most leaf \n
into the right side of the tree"</span>)</div><div class='output co'>#&gt; <span class='error'>Error in rotate(hc, c(2:5, 1)): object "phy" is not of class "phylo"</span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>3</span>))</div><div class='img'><img src='rotate-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>dend</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Original tree"</span>)
<span class='no'>dend</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"labels sort"</span>)
<span class='no'>dend</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"nodes"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"nodes (ladderize) sort"</span>)</div><div class='img'><img src='rotate-5.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tal Galili, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


