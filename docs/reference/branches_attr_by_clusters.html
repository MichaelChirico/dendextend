<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Change col/lwd/lty of branches based on clusters — branches_attr_by_clusters • dendextend</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Change col/lwd/lty of branches based on clusters — branches_attr_by_clusters" />
<meta property="og:description" content="The user supplies a dend, a vector of clusters, and what to modify (and how).
And the function returns a dendrogram with branches col/lwd/lty accordingly.
(the function assumes unique labels)" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dendextend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.14.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dendextend.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Cluster_Analysis.html">Hierarchical cluster analysis on famous data sets - enhanced with the _dendextend_ package</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/Quick_Introduction.html">Quick Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/talgalili/dendextend/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Change col/lwd/lty of branches based on clusters</h1>
    <small class="dont-index">Source: <a href='https://github.com/talgalili/dendextend/blob/master/R/branches_attr_by.R'><code>R/branches_attr_by.R</code></a></small>
    <div class="hidden name"><code>branches_attr_by_clusters.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The user supplies a dend, a vector of clusters, and what to modify (and how).</p>
<p>And the function returns a dendrogram with branches col/lwd/lty accordingly.
(the function assumes unique labels)</p>
    </div>

    <pre class="usage"><span class='fu'>branches_attr_by_clusters</span>(
  <span class='no'>dend</span>,
  <span class='no'>clusters</span>,
  <span class='no'>values</span>,
  <span class='kw'>attr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"col"</span>, <span class='st'>"lwd"</span>, <span class='st'>"lty"</span>),
  <span class='kw'>branches_changed_have_which_labels</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"any"</span>, <span class='st'>"all"</span>),
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dend</th>
      <td><p>a dendrogram dend</p></td>
    </tr>
    <tr>
      <th>clusters</th>
      <td><p>an integer vector of clusters.
This HAS to be of the same length as the number of leaves.
Items that belong to no cluster should get the value 0.
The vector should be of the same order as that of the labels in the dendrogram.
If you create the clusters from something like <a href='cutree-methods.html'>cutree</a> you would first
need to use <a href='https://rdrr.io/r/stats/order.dendrogram.html'>order.dendrogram</a> on it, before using it in the function.</p></td>
    </tr>
    <tr>
      <th>values</th>
      <td><p>the attributes to use for non 0 values.
This should be of the same length as the number of unique non-0 clusters.
If it is shorter, it is recycled.</p>
<p>OR, this can also be of the same length as the number of leaves in the tree
In which case, the values will be aggreagted (i.e.: <a href='https://rdrr.io/r/base/tapply.html'>tapply</a>), to match
the number of clusters. The first value of each cluster will be used as the main
value.</p>
<p>TODO: So far, the function doesn't deal well with NA values. (this might be changed in the future)</p></td>
    </tr>
    <tr>
      <th>attr</th>
      <td><p>a character with one of the following values: col/lwd/lty</p></td>
    </tr>
    <tr>
      <th>branches_changed_have_which_labels</th>
      <td><p>character with either "any" (default) or "all".
Inidicates how the branches should be updated.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>ignored.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A dendrogram with modified branches (col/lwd/lty).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is probably NOT a very fast implementation of the function, but it works.</p>
<p>This function was designed to enable the manipulation (mainly coloring) of
branches, based on the results from the <a href='https://rdrr.io/pkg/dynamicTreeCut/man/cutreeDynamic.html'>cutreeDynamic</a>
function.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='branches_attr_by_labels.html'>branches_attr_by_labels</a>,
<a href='get_leaves_attr.html'>get_leaves_attr</a>, <a href='nnodes.html'>nnodes</a>, <a href='nleaves.html'>nleaves</a>
<a href='https://rdrr.io/pkg/dynamicTreeCut/man/cutreeDynamic.html'>cutreeDynamic</a>,
plotDendroAndColors</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {

<span class='co'>### Getting the hc object</span>
<span class='no'>iris_dist</span> <span class='kw'>&lt;-</span> <span class='no'>iris</span>[, -<span class='fl'>5</span>] <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>()
<span class='no'>hc</span> <span class='kw'>&lt;-</span> <span class='no'>iris_dist</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>()
<span class='co'># This is how it looks without any colors:</span>
<span class='no'>dend</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>(<span class='no'>hc</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>dend</span>)

<span class='co'># Both functions give the same outcome</span>
<span class='co'># options 1:</span>
<span class='no'>dend</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='set.html'>set</a></span>(<span class='st'>"branches_k_color"</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>4</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>()
<span class='co'># options 2:</span>
<span class='no'>clusters</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='cutree-methods.html'>cutree</a></span>(<span class='no'>dend</span>, <span class='fl'>4</span>)[<span class='fu'><a href='https://rdrr.io/r/stats/order.dendrogram.html'>order.dendrogram</a></span>(<span class='no'>dend</span>)]
<span class='no'>dend</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>branches_attr_by_clusters</span>(<span class='no'>clusters</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>()

<span class='co'># and the second option is much slower:</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='fu'><a href='set.html'>set</a></span>(<span class='no'>dend</span>, <span class='st'>"branches_k_color"</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>4</span>)) <span class='co'># 0.26 sec</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='fu'>branches_attr_by_clusters</span>(<span class='no'>dend</span>, <span class='no'>clusters</span>)) <span class='co'># 1.61 sec</span>
<span class='co'># BUT, it also allows us to do more flaxible things!</span>

<span class='co'>#--------------------------</span>
<span class='co'>#   Plotting dynamicTreeCut</span>
<span class='co'>#--------------------------</span>

<span class='co'># let's get the clusters</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dynamicTreeCut</span>)
<span class='no'>clusters</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/dynamicTreeCut/man/cutreeDynamic.html'>cutreeDynamic</a></span>(<span class='no'>hc</span>, <span class='kw'>distM</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>iris_dist</span>))
<span class='co'># we need to sort them to the order of the dendrogram:</span>
<span class='no'>clusters</span> <span class='kw'>&lt;-</span> <span class='no'>clusters</span>[<span class='fu'><a href='https://rdrr.io/r/stats/order.dendrogram.html'>order.dendrogram</a></span>(<span class='no'>dend</span>)]

<span class='co'># get some functions:</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dendextendRcpp</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>colorspace</span>)
<span class='no'>no0_unique</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) {
  <span class='no'>u_x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>x</span>)
  <span class='no'>u_x</span>[<span class='no'>u_x</span> <span class='kw'>!=</span> <span class='fl'>0</span>]
}

<span class='no'>clusters_numbers</span> <span class='kw'>&lt;-</span> <span class='fu'>no0_unique</span>(<span class='no'>clusters</span>)
<span class='no'>n_clusters</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>clusters_numbers</span>)
<span class='no'>cols</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://colorspace.R-Forge.R-project.org//reference/rainbow_hcl.html'>rainbow_hcl</a></span>(<span class='no'>n_clusters</span>)
<span class='no'>dend2</span> <span class='kw'>&lt;-</span> <span class='fu'>branches_attr_by_clusters</span>(<span class='no'>dend</span>, <span class='no'>clusters</span>, <span class='kw'>values</span> <span class='kw'>=</span> <span class='no'>cols</span>)
<span class='co'># dend2 &lt;- branches_attr_by_clusters(dend, clusters)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>dend2</span>)
<span class='co'># add colored bars:</span>
<span class='no'>ord_cols</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://colorspace.R-Forge.R-project.org//reference/rainbow_hcl.html'>rainbow_hcl</a></span>(<span class='no'>n_clusters</span>)[<span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span>(<span class='no'>clusters_numbers</span>)]
<span class='no'>tmp_cols</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>clusters</span>))
<span class='no'>tmp_cols</span>[<span class='no'>clusters</span> <span class='kw'>!=</span> <span class='fl'>0</span>] <span class='kw'>&lt;-</span> <span class='no'>ord_cols</span>[<span class='no'>clusters</span> <span class='kw'>!=</span> <span class='fl'>0</span>][<span class='no'>clusters</span>]
<span class='fu'><a href='colored_bars.html'>colored_bars</a></span>(<span class='no'>tmp_cols</span>, <span class='kw'>y_shift</span> <span class='kw'>=</span> -<span class='fl'>1.1</span>, <span class='kw'>rowLabels</span> <span class='kw'>=</span> <span class='st'>""</span>)
<span class='co'># all of the ordering is to handle the fact that the cluster numbers are not ascending...</span>

<span class='co'># How is this compared with the usual cutree?</span>
<span class='no'>dend3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='color_branches.html'>color_branches</a></span>(<span class='no'>dend</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>n_clusters</span>)
<span class='fu'><a href='https://rdrr.io/r/base/labels.html'>labels</a></span>(<span class='no'>dend2</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/labels.html'>labels</a></span>(<span class='no'>dend2</span>))
<span class='co'># this needs fixing, since the labels are not character!</span>
<span class='co'># Well, both cluster solutions are not perfect, but at least they are interesting...</span>
<span class='fu'><a href='tanglegram.html'>tanglegram</a></span>(<span class='no'>dend2</span>, <span class='no'>dend3</span>,
  <span class='kw'>main_left</span> <span class='kw'>=</span> <span class='st'>"cutreeDynamic"</span>, <span class='kw'>main_right</span> <span class='kw'>=</span> <span class='st'>"cutree"</span>,
  <span class='kw'>columns_width</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>, <span class='fl'>.5</span>, <span class='fl'>5</span>),
  <span class='kw'>color_lines</span> <span class='kw'>=</span> <span class='no'>cols</span>[<span class='no'>iris</span>[<span class='fu'><a href='https://rdrr.io/r/stats/order.dendrogram.html'>order.dendrogram</a></span>(<span class='no'>dend2</span>), <span class='fl'>5</span>]]
)
<span class='co'># (Notice how the color_lines is of the true Species of each Iris)</span>
<span class='co'># The main difference is at the bottom,</span>
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tal Galili, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


