<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Highlight a dendrogram's branches heights via color and line-width — highlight_branches_col • dendextend</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Highlight a dendrogram's branches heights via color and line-width — highlight_branches_col" />

<meta property="og:description" content="Highlights (update) the color (col) and/or line width (lwd) of each branch in
a dendrogram based on it's node's height.
This is a powerful pre-processing for a tanglegram plot of two dendrograms, as
it emphasizes the toplogical structure of each tree (and hence, their similarity and differences).
The colors are based on the viridis pallette, and the line width is on the range of 1 to 10.
These can be manually changed when using highlight_branches_col and highlight_branches_lwd
respectively." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dendextend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.13.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dendextend.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Cluster_Analysis.html">Hierarchical cluster analysis on famous data sets - enhanced with the _dendextend_ package</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/Quick_Introduction.html">Quick Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/talgalili/dendextend">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Highlight a dendrogram's branches heights via color and line-width</h1>
    <small class="dont-index">Source: <a href='https://github.com/talgalili/dendextend/blob/master/R/highlight_branches.R'><code>R/highlight_branches.R</code></a></small>
    <div class="hidden name"><code>highlight_branches.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Highlights (update) the color (col) and/or line width (lwd) of each branch in
a dendrogram based on it's node's height.
This is a powerful pre-processing for a <a href='tanglegram.html'>tanglegram</a> plot of two dendrograms, as
it emphasizes the toplogical structure of each tree (and hence, their similarity and differences).</p>
<p>The colors are based on the viridis pallette, and the line width is on the range of 1 to 10.
These can be manually changed when using highlight_branches_col and highlight_branches_lwd
respectively.</p>
    
    </div>

    <pre class="usage"><span class='fu'>highlight_branches_col</span>(<span class='no'>dend</span>, <span class='kw'>values</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span>(<span class='fu'>viridis</span>(<span class='fl'>1000</span>, <span class='kw'>end</span> <span class='kw'>=</span> <span class='fl'>0.9</span>)), <span class='no'>...</span>)

<span class='fu'>highlight_branches_lwd</span>(<span class='no'>dend</span>, <span class='kw'>values</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>1</span>, <span class='fl'>10</span>, <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='fl'>1000</span>), <span class='no'>...</span>)

<span class='fu'>highlight_branches</span>(<span class='no'>dend</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"col"</span>, <span class='st'>"lwd"</span>), <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dend</th>
      <td><p>a <a href='https://rdrr.io/r/stats/dendrogram.html'>dendrogram</a> tree (to be turned into a ggdend object)</p></td>
    </tr>
    <tr>
      <th>values</th>
      <td><p>the gradient of values to be used for each branch.
The colors are based on the viridis pallette, and the line width is on the range of 1 to 10.
These can be manually changed when using highlight_branches_col and highlight_branches_lwd
respectively.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently ignored.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>a character vector. Either "col", "lwd", or both. Based on
whichever is chosen the dendrogram's branches will be updated.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A modified <a href='https://rdrr.io/r/stats/dendrogram.html'>dendrogram</a>, with colors/line-width in the branches
that are proportional to each branche's height (measured by its lower tip).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='set.html'>set</a>, <a href='color_branches.html'>color_branches</a>, <a href='get_branches_heights.html'>get_branches_heights</a>,
<a href='https://rdrr.io/pkg/viridis/man/reexports.html'>viridis</a></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>

<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>iris</span>[<span class='fl'>1</span>:<span class='fl'>20</span>, -<span class='fl'>5</span>]
<span class='no'>hca</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>(<span class='no'>dat</span>))
<span class='no'>hca2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>(<span class='no'>dat</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"single"</span>)
<span class='no'>dend</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>(<span class='no'>hca</span>)
<span class='no'>dend2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>(<span class='no'>hca2</span>)

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>3</span>))
<span class='no'>dend</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>highlight_branches_col</span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Coloring branches"</span>)
<span class='no'>dend</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>highlight_branches_lwd</span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Emphasizing line-width"</span>)
<span class='no'>dend</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>highlight_branches</span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Emphasizing color\n and line-width"</span>)</div><div class='img'><img src='highlight_branches-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>viridis</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: viridisLite</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>3</span>))
<span class='no'>dend</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>highlight_branches_col</span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Coloring branches \n(default is reversed viridis)"</span>)
<span class='no'>dend</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>highlight_branches_col</span>(<span class='fu'><a href='https://rdrr.io/pkg/viridis/man/reexports.html'>viridis</a></span>(<span class='fl'>100</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"It is better to use\nlighter colors in the leaves"</span>)
<span class='no'>dend</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>highlight_branches_col</span>(<span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/viridis/man/reexports.html'>magma</a></span>(<span class='fl'>1000</span>))) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"The magma color pallatte\n is also good"</span>)</div><div class='img'><img src='highlight_branches-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>dl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='dendlist.html'>dendlist</a></span>(<span class='no'>dend</span>, <span class='no'>dend2</span>)
<span class='fu'><a href='tanglegram.html'>tanglegram</a></span>(<span class='no'>dl</span>,
  <span class='kw'>sort</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>common_subtrees_color_lines</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>highlight_distinct_edges</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>highlight_branches_lwd</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</div><div class='img'><img src='highlight_branches-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='tanglegram.html'>tanglegram</a></span>(<span class='no'>dl</span>)</div><div class='img'><img src='highlight_branches-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='tanglegram.html'>tanglegram</a></span>(<span class='no'>dl</span>, <span class='kw'>fast</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='img'><img src='highlight_branches-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>dl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='dendlist.html'>dendlist</a></span>(<span class='fu'>highlight_branches</span>(<span class='no'>dend</span>), <span class='fu'>highlight_branches</span>(<span class='no'>dend2</span>))
<span class='fu'><a href='tanglegram.html'>tanglegram</a></span>(<span class='no'>dl</span>, <span class='kw'>sort</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>common_subtrees_color_lines</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>highlight_distinct_edges</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='highlight_branches-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>dend</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='set.html'>set</a></span>(<span class='st'>"highlight_branches_col"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>()

<span class='no'>dl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='dendlist.html'>dendlist</a></span>(<span class='no'>dend</span>, <span class='no'>dend2</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='set.html'>set</a></span>(<span class='st'>"highlight_branches_col"</span>)
<span class='fu'><a href='tanglegram.html'>tanglegram</a></span>(<span class='no'>dl</span>, <span class='kw'>sort</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>common_subtrees_color_lines</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>highlight_distinct_edges</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='highlight_branches-7.png' alt='' width='700' height='433' /></div><div class='img'><img src='highlight_branches-8.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># This is also useful for heatmaps</span>
<span class='co'># --------------------------</span>
<span class='co'># library(dendextend)</span>

<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='kw pkg'>datasets</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/r/datasets/mtcars.html'>mtcars</a></span>)

<span class='no'>Rowv</span> <span class='kw'>&lt;-</span> <span class='no'>x</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='set.html'>set</a></span>(<span class='st'>"branches_k_color"</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='set.html'>set</a></span>(<span class='st'>"highlight_branches_lwd"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='ladderize.html'>ladderize</a></span>()</div><div class='output co'>#&gt; <span class='error'>Error in oV(x, wts): argument "wts" is missing, with no default</span></div><div class='input'><span class='co'>#    rotate_DendSer(ser_weight = dist(x))</span>
<span class='no'>Colv</span> <span class='kw'>&lt;-</span> <span class='no'>x</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='set.html'>set</a></span>(<span class='st'>"branches_k_color"</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>2</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='set.html'>set</a></span>(<span class='st'>"highlight_branches_lwd"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='ladderize.html'>ladderize</a></span>()</div><div class='output co'>#&gt; <span class='error'>Error in oV(x, wts): argument "wts" is missing, with no default</span></div><div class='input'><span class='co'>#    rotate_DendSer(ser_weight = dist(t(x)))</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>gplots</span>)
<span class='fu'><a href='https://rdrr.io/pkg/gplots/man/heatmap.2.html'>heatmap.2</a></span>(<span class='no'>x</span>, <span class='kw'>Rowv</span> <span class='kw'>=</span> <span class='no'>Rowv</span>, <span class='kw'>Colv</span> <span class='kw'>=</span> <span class='no'>Colv</span>)</div><div class='output co'>#&gt; <span class='error'>Error in heatmap.2(x, Rowv = Rowv, Colv = Colv): object 'Rowv' not found</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tal Galili, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


