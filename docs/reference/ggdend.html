<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Creates dendrogram plot using ggplot. — ggdend • dendextend</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Creates dendrogram plot using ggplot. — ggdend" />

<meta property="og:description" content="Several functions for creating a dendrogram plot using ggplot2.
The core process is to transform a dendrogram into a ggdend object using as.ggdend,
and then plot it using ggplot. These two steps can be done in one command with either the function
ggplot or ggdend.
The reason we want to have as.ggdend (and not only ggplot.dendrogram), is (1) so that you could
create your own mapping of ggdend and, (2) since as.ggdend might be slow for large trees,
it is probably better to be able to run it only once for such cases.
A ggdend class object is a list with 3 componants: segments, labels, nodes.
Each one contains the graphical parameters from the original dendrogram, but in a tabular form that
can be used by ggplot2+geom_segment+geom_text to create a dendrogram plot." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dendextend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.13.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dendextend.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Cluster_Analysis.html">Hierarchical cluster analysis on famous data sets - enhanced with the _dendextend_ package</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/Quick_Introduction.html">Quick Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/talgalili/dendextend">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Creates dendrogram plot using ggplot.</h1>
    <small class="dont-index">Source: <a href='https://github.com/talgalili/dendextend/blob/master/R/ggdend.R'><code>R/ggdend.R</code></a></small>
    <div class="hidden name"><code>ggdend.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Several functions for creating a dendrogram plot using ggplot2.
The core process is to transform a dendrogram into a ggdend object using as.ggdend,
and then plot it using ggplot. These two steps can be done in one command with either the function
ggplot or ggdend.</p>
<p>The reason we want to have as.ggdend (and not only ggplot.dendrogram), is (1) so that you could
create your own mapping of ggdend and, (2) since as.ggdend might be slow for large trees,
it is probably better to be able to run it only once for such cases.</p>
<p>A ggdend class object is a list with 3 componants: segments, labels, nodes.
Each one contains the graphical parameters from the original dendrogram, but in a tabular form that
can be used by ggplot2+geom_segment+geom_text to create a dendrogram plot.</p>
    
    </div>

    <pre class="usage"><span class='fu'>ggdend</span>(<span class='no'>...</span>)

<span class='fu'>as.ggdend</span>(<span class='no'>dend</span>, <span class='no'>...</span>)

<span class='co'># S3 method for dendrogram</span>
<span class='fu'>as.ggdend</span>(<span class='no'>dend</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"rectangle"</span>, <span class='st'>"triangle"</span>), <span class='kw'>edge.root</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='fu'>prepare.ggdend</span>(<span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S3 method for ggdend</span>
<span class='fu'>ggplot</span>(
  <span class='no'>data</span>,
  <span class='kw'>segments</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>nodes</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>horiz</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>theme</span> <span class='kw'>=</span> <span class='fu'><a href='theme_dendro.html'>theme_dendro</a></span>(),
  <span class='kw'>offset_labels</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>
)

<span class='co'># S3 method for dendrogram</span>
<span class='fu'>ggplot</span>(<span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S3 method for ggdend</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>mostly ignored.</p></td>
    </tr>
    <tr>
      <th>dend</th>
      <td><p>a <a href='https://rdrr.io/r/stats/dendrogram.html'>dendrogram</a> tree (to be turned into a ggdend object)</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>The type of plot, indicating the shape of the dendrogram.  "rectangle" will draw
rectangular lines, while "triangle" will draw triangular lines.</p></td>
    </tr>
    <tr>
      <th>edge.root</th>
      <td><p>currently ignored. One day it might do the following: logical; if true, draw an edge to the root node.</p></td>
    </tr>
    <tr>
      <th>data, x</th>
      <td><p>a ggdend class object (passed to ggplot.dendrogram or print.ggdend).</p></td>
    </tr>
    <tr>
      <th>segments</th>
      <td><p>a logical (TRUE) if to plot the segments (branches).</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>a logical (TRUE) if to plot the labels.</p></td>
    </tr>
    <tr>
      <th>nodes</th>
      <td><p>a logical (TRUE) if to plot the nodes (points).</p></td>
    </tr>
    <tr>
      <th>horiz</th>
      <td><p>a logical (TRUE) indicating if the dendrogram should be drawn horizontally or not.</p></td>
    </tr>
    <tr>
      <th>theme</th>
      <td><p>the ggplot2 theme to use (default is <a href='theme_dendro.html'>theme_dendro</a>, can also be NULL
for the default ggplot2 theme)</p></td>
    </tr>
    <tr>
      <th>offset_labels</th>
      <td><p>a numeric value to offset the labels from the leaves</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>A logical (TRUE) to control removal of missing values. Passed to
<a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a> and <a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>These are extended versions of the functions ggdendrogram, dendro_data (and the hidden dendrogram_data)
from Andrie de Vries's ggdendro package. The motivation for this fork is the need to add more graphical parameters
to the plotted tree. This required a strong mixter of functions from ggdendro and dendextend (to the point that
it seemed better to just fork the code into its current form)</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    
<ul>
<li><p><code>as.ggdend</code> - returns an object of class ggdend which is a list with 3 componants: segments, labels, nodes.
Each one contains the graphical parameters from the original dendrogram, but in a tabular form that
can be used by ggplot2+geom_segment+geom_text to create a dendrogram plot.</p></li>
<li><p><code>prepare.ggdend</code> - a <code>ggdend</code> object (after filling it with various default values)</p></li>
<li><p><code>ggplot.ggdend</code> - a <a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a> object</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>prepare.ggdend</code> is used by <code>plot.ggdend</code> to take the <code>ggdend</code> object
and prepare it for plotting. This is because the defaults of various parameters in <a href='https://rdrr.io/r/stats/dendrogram.html'>dendrogram</a>'s
are not always stored in the object itself, but are built-in into the <a href='https://rdrr.io/r/stats/dendrogram.html'>plot.dendrogram</a> function.
For example, the color of the labels is not (by default) specified in the dendrogram (only if we change it
from black to something else). Hence, when taking the object into a different plotting engine (say ggplot2), we
want to prepare the object by filling-in various defaults.
This function is autmatically invoked within the <code>plot.ggdend</code> function. You would probably use
it only if you'd wish to build your own ggplot2 mapping.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='https://rdrr.io/r/stats/dendrogram.html'>dendrogram</a>, <a href='get_nodes_attr.html'>get_nodes_attr</a>, <a href='get_leaves_nodePar.html'>get_leaves_nodePar</a>,
<a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a>,
ggdendrogram, dendro_data,</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dendextend</span>)
<span class='co'># library(ggdendro)</span>
<span class='co'># Create a complex dend:</span>
<span class='no'>dend</span> <span class='kw'>&lt;-</span> <span class='no'>iris</span>[<span class='fl'>1</span>:<span class='fl'>30</span>, -<span class='fl'>5</span>] <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='set.html'>set</a></span>(<span class='st'>"branches_k_color"</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='set.html'>set</a></span>(<span class='st'>"branches_lwd"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.5</span>, <span class='fl'>1</span>, <span class='fl'>1.5</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='set.html'>set</a></span>(<span class='st'>"branches_lty"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>2</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='set.html'>set</a></span>(<span class='st'>"labels_colors"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='set.html'>set</a></span>(<span class='st'>"labels_cex"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.9</span>, <span class='fl'>1.2</span>))
<span class='co'># plot the dend in usual "base" plotting engine:</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>dend</span>)
<span class='co'># Now let's do it in ggplot2 :)</span>
<span class='no'>ggd1</span> <span class='kw'>&lt;-</span> <span class='fu'>as.ggdend</span>(<span class='no'>dend</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ggplot2</span>)
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='no'>ggd1</span>) <span class='co'># reproducing the above plot in ggplot2 :)</span>


<span class='fu'><a href='https://rdrr.io/r/base/labels.html'>labels</a></span>(<span class='no'>dend</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/labels.html'>labels</a></span>(<span class='no'>dend</span>), <span class='st'>"00000"</span>)
<span class='no'>ggd1</span> <span class='kw'>&lt;-</span> <span class='fu'>as.ggdend</span>(<span class='no'>dend</span>)
<span class='co'># Use ylim to deal with long labels in ggplot2</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='no'>ggd1</span>) + <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span>(-<span class='fl'>.4</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='fu'><a href='get_branches_heights.html'>get_branches_heights</a></span>(<span class='no'>dend</span>)))


<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='no'>ggd1</span>, <span class='kw'>horiz</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='co'># horiz plot in ggplot2</span>
<span class='co'># Adding some extra spice to it...</span>
<span class='co'># creating a radial plot:</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='no'>ggd1</span>) + <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_reverse</a></span>(<span class='kw'>expand</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.2</span>, <span class='fl'>0</span>)) + <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_polar.html'>coord_polar</a></span>(<span class='kw'>theta</span> <span class='kw'>=</span> <span class='st'>"x"</span>)
<span class='co'># The text doesn't look so great, so let's remove it:</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='no'>ggd1</span>, <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>) + <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_reverse</a></span>(<span class='kw'>expand</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.2</span>, <span class='fl'>0</span>)) + <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_polar.html'>coord_polar</a></span>(<span class='kw'>theta</span> <span class='kw'>=</span> <span class='st'>"x"</span>)

<span class='co'># This can now be sent to plot.ly - which adds zoom-in abilities, and more.</span>
<span class='co'># Here is how it might look like: https://plot.ly/~talgalili/6/y-vs-x/</span>

<span class='co'>## Quick guide:</span>
<span class='co'># install.packages("devtools")</span>
<span class='co'># library("devtools")</span>
<span class='co'># devtools::install_github("ropensci/plotly")</span>
<span class='co'># library(plotly)</span>
<span class='co'># set_credentials_file(...)</span>
<span class='co'># you'll need to get it from here: https://plot.ly/ggplot2/getting-started/</span>

<span class='co'># ggplot(ggd1)</span>
<span class='co'># py &lt;- plotly()</span>
<span class='co'># py$ggplotly()</span>

<span class='co'># And you'll get something like this: https://plot.ly/~talgalili/6/y-vs-x/</span>

<span class='co'># Another example: https://plot.ly/ggplot2/</span>
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#source">Source</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Tal Galili, using code modified from Andrie de Vries</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tal Galili, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


