<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Frequently asked questions • dendextend</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Frequently asked questions">
<meta property="og:description" content="dendextend">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dendextend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.13.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dendextend.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Cluster_Analysis.html">Hierarchical cluster analysis on famous data sets - enhanced with the _dendextend_ package</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/Quick_Introduction.html">Quick Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/talgalili/dendextend/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Frequently asked questions</h1>
                        <h4 class="author">Tal Galili</h4>
            
            <h4 class="date">2020-03-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/talgalili/dendextend/blob/master/vignettes/FAQ.Rmd"><code>vignettes/FAQ.Rmd</code></a></small>
      <div class="hidden name"><code>FAQ.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Frequently asked questions}
-->
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Questions are often taken from here the <a href="http://stackoverflow.com/questions/tagged/dendrogram+r">stackoverflow <code>dendrogram</code> tag</a>.</p>
<div id="how-to-colour-the-labels-of-a-dendrogram-by-an-additional-factor-variable" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-colour-the-labels-of-a-dendrogram-by-an-additional-factor-variable" class="anchor"></a>How to colour the labels of a dendrogram by an additional factor variable</h3>
<p>Asked (<a href="http://stackoverflow.com/questions/27485549/how-to-colour-the-labels-of-a-dendrogram-by-an-additional-factor-variable-in-r" class="uri">http://stackoverflow.com/questions/27485549/how-to-colour-the-labels-of-a-dendrogram-by-an-additional-factor-variable-in-r</a>)[here].</p>
<p>Solution: use the <code>labels_colors</code> function.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="co"># install.packages("dendextend")</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dendextend</span>)

<span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="no">USArrests</span>[<span class="fl">1</span>:<span class="fl">5</span>,])))
<span class="co"># Like: </span>
<span class="co"># dend &lt;- USArrests[1:5,] %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram</span>

<span class="co"># By default, the dend has no colors to the labels</span>
<span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span>(<span class="no">dend</span>)</pre></body></html></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">dend</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Original dend"</span>)

<span class="co"># let's add some color:</span>
<span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span>(<span class="no">dend</span>) <span class="kw">&lt;-</span> <span class="fl">1</span>:<span class="fl">5</span>
<span class="co"># Now each state has a color</span>
<span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span>(<span class="no">dend</span>)</pre></body></html></div>
<pre><code>##   Arkansas    Arizona California    Alabama     Alaska 
##          1          2          3          4          5</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">dend</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"A color for every state"</span>)</pre></body></html></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-2-1.png" width="600"></p>
<p>Instead of using <code>1:5</code>, we can obviously use colors that are based on another factor (organized): the labels themselves. But in such a case, we want to map between the order of the labels and the order of the items in the original dataset. Here is another example based on the iris dataset:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="co"># install.packages("dendextend")</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dendextend</span>)

<span class="no">small_iris</span> <span class="kw">&lt;-</span> <span class="no">iris</span>[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">51</span>, <span class="fl">101</span>, <span class="fl">2</span>, <span class="fl">52</span>, <span class="fl">102</span>), ]
<span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="no">small_iris</span>[,-<span class="fl">5</span>])))
<span class="co"># Like: </span>
<span class="co"># dend &lt;- small_iris[,-5] %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram</span>

<span class="co"># By default, the dend has no colors to the labels</span>
<span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span>(<span class="no">dend</span>)</pre></body></html></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">dend</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Original dend"</span>)

<span class="co"># Let's add some color:</span>
<span class="no">colors_to_use</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">small_iris</span>[,<span class="fl">5</span>])
<span class="no">colors_to_use</span></pre></body></html></div>
<pre><code>## [1] 1 2 3 1 2 3</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="co"># But sort them based on their order in dend:</span>
<span class="no">colors_to_use</span> <span class="kw">&lt;-</span> <span class="no">colors_to_use</span>[<span class="fu"><a href="https://rdrr.io/r/stats/order.dendrogram.html">order.dendrogram</a></span>(<span class="no">dend</span>)]
<span class="no">colors_to_use</span></pre></body></html></div>
<pre><code>## [1] 1 1 2 2 3 3</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="co"># Now we can use them</span>
<span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span>(<span class="no">dend</span>) <span class="kw">&lt;-</span> <span class="no">colors_to_use</span>
<span class="co"># Now each state has a color</span>
<span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span>(<span class="no">dend</span>)</pre></body></html></div>
<pre><code>##   1   2  51  52 101 102 
##   1   1   2   2   3   3</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">dend</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"A color for every Species"</span>)</pre></body></html></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-3-1.png" width="600"></p>
</div>
<div id="how-to-color-a-dendrograms-labels-according-to-defined-groups-in-r" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-color-a-dendrograms-labels-according-to-defined-groups-in-r" class="anchor"></a>How to color a dendrogram’s labels according to defined groups? (in R)</h3>
<p>Asked (<a href="http://stackoverflow.com/questions/31117849/how-to-color-a-dendrograms-labels-according-to-defined-groups-in-r" class="uri">http://stackoverflow.com/questions/31117849/how-to-color-a-dendrograms-labels-according-to-defined-groups-in-r</a>)[here].</p>
<p>Solution: use the <code>color_labels</code> function.</p>
<p>I suspect the function you are looking for is either <code>color_labels</code> or <code>get_leaves_branches_col</code>. The first color your labels based on <code>cutree</code> (like <code>color_branches</code> do) and the second allows you to get the colors of the branch of each leaf, and then use it to color the labels of the tree (if you use unusual methods for coloring the branches (as happens when using <code>branches_attr_by_labels</code>). For example:</p>
<div class="sourceCode"><html><body><pre class="r"> <span class="co"># define dendrogram object to play with:</span>
 <span class="no">hc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="no">USArrests</span>[<span class="fl">1</span>:<span class="fl">5</span>,]), <span class="st">"ave"</span>)
 <span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="no">hc</span>)

 <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dendextend</span>)
 <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>), <span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span>))
 <span class="no">dend</span> <span class="kw">&lt;-</span> <span class="no">dend</span> <span class="kw">%&gt;%</span>
          <span class="fu"><a href="../reference/color_branches.html">color_branches</a></span>(<span class="kw">k</span> <span class="kw">=</span> <span class="fl">3</span>) <span class="kw">%&gt;%</span>
          <span class="fu"><a href="../reference/set.html">set</a></span>(<span class="st">"branches_lwd"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>)) <span class="kw">%&gt;%</span>
          <span class="fu"><a href="../reference/set.html">set</a></span>(<span class="st">"branches_lty"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>))

 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">dend</span>)

 <span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/color_labels.html">color_labels</a></span>(<span class="no">dend</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">3</span>)
 <span class="co"># The same as:</span>
 <span class="co"># labels_colors(dend)  &lt;- get_leaves_branches_col(dend)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">dend</span>)</pre></body></html></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-4-1.png" width="450"></p>
<p>Either way, you should always have a look at the <code>set</code> function, for ideas on what can be done to your dendrogram (this saves the hassle of remembering all the different functions names).</p>
</div>
<div id="how-to-color-a-dendrograms-brancheslabels-based-on-cluster-i-e--cutree-result" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-color-a-dendrograms-brancheslabels-based-on-cluster-i-e--cutree-result" class="anchor"></a>How to color a dendrogram’s branches/labels based on cluster (i.e.: cutree result)</h3>
<p>Use the <code>color_branches</code> and <code>color_labels</code> functions, with the <code>k</code> (or<code>h</code>) parameter:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="co"># install.packages("dendextend")</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dendextend</span>)

<span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="no">USArrests</span>[<span class="fl">1</span>:<span class="fl">5</span>,])))
<span class="co"># Like: </span>
<span class="co"># dend &lt;- USArrests[1:5,] %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram</span>

<span class="no">dend1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/color_branches.html">color_branches</a></span>(<span class="no">dend</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="no">dend2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/color_labels.html">color_labels</a></span>(<span class="no">dend</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">3</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">dend1</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Colored branches"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">dend2</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Colored labels"</span>)</pre></body></html></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-5-1.png" width="600"></p>
</div>
<div id="change-dendrograms-labels" class="section level3">
<h3 class="hasAnchor">
<a href="#change-dendrograms-labels" class="anchor"></a>Change dendrogram’s labels</h3>
<p>Use the left assign <code>labels&lt;-</code> function:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="co"># install.packages("dendextend")</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dendextend</span>)

<span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="no">USArrests</span>[<span class="fl">1</span>:<span class="fl">5</span>,])))
<span class="co"># Like: </span>
<span class="co"># dend &lt;- USArrests[1:5,] %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram</span>

<span class="fu"><a href="https://rdrr.io/r/base/labels.html">labels</a></span>(<span class="no">dend</span>)</pre></body></html></div>
<pre><code>## [1] "Arkansas"   "Arizona"    "California" "Alabama"    "Alaska"</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/labels.html">labels</a></span>(<span class="no">dend</span>) <span class="kw">&lt;-</span> <span class="fl">1</span>:<span class="fl">5</span>
<span class="fu"><a href="https://rdrr.io/r/base/labels.html">labels</a></span>(<span class="no">dend</span>)</pre></body></html></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
</div>
<div id="larger-font-for-leaves-in-a-dendrogram" class="section level3">
<h3 class="hasAnchor">
<a href="#larger-font-for-leaves-in-a-dendrogram" class="anchor"></a>Larger font for leaves in a dendrogram</h3>
<p>Asked (<a href="http://stackoverflow.com/questions/26965390/larger-font-and-spacing-between-leaves-in-r-dendrogram" class="uri">http://stackoverflow.com/questions/26965390/larger-font-and-spacing-between-leaves-in-r-dendrogram</a>)[here].</p>
<p>Solution: use the <code>set</code> function, with the “labels_cex” parameter.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="co"># install.packages("dendextend")</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dendextend</span>)

<span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="no">USArrests</span>[<span class="fl">1</span>:<span class="fl">5</span>,])))
<span class="co"># Like: </span>
<span class="co"># dend &lt;- USArrests[1:5,] %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram</span>

<span class="co"># By default, the dend has no text size to it (showing only the first leaf)</span>
<span class="fu"><a href="../reference/get_leaves_nodePar.html">get_leaves_nodePar</a></span>(<span class="no">dend</span>)<span class="kw">[[</span><span class="fl">1</span>]]</pre></body></html></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>), <span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">dend</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Original dend"</span>)

<span class="co"># let's increase the size of the labels:</span>
<span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/set.html">set</a></span>(<span class="no">dend</span>, <span class="st">"labels_cex"</span>, <span class="fl">2</span>)
<span class="co"># Now each state has a larger label</span>
<span class="fu"><a href="../reference/get_leaves_nodePar.html">get_leaves_nodePar</a></span>(<span class="no">dend</span>)<span class="kw">[[</span><span class="fl">1</span>]]</pre></body></html></div>
<pre><code>## $lab.cex
## [1] 2
## 
## $pch
## [1] NA</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">dend</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"A larger font for labels"</span>)</pre></body></html></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-7-1.png" width="600"></p>
<p>(Note that changing the spacing between the labels is currently not implemented)</p>
</div>
<div id="how-to-view-attributes-of-a-dendrogram" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-view-attributes-of-a-dendrogram" class="anchor"></a>How to view attributes of a dendrogram</h3>
<p>Asked (<a href="http://stackoverflow.com/questions/26240200/how-to-access-attributes-of-a-dendrogram-in-r" class="uri">http://stackoverflow.com/questions/26240200/how-to-access-attributes-of-a-dendrogram-in-r</a>)[here], and (<a href="http://stackoverflow.com/questions/25664911/r-hclust-height-of-final-merge" class="uri">http://stackoverflow.com/questions/25664911/r-hclust-height-of-final-merge</a>)[here].</p>
<p>It generally depends on which attribute we want to view. For “midpoint” (or height) use the <code>get_nodes_attr</code> function, with the “midpoint” parameter.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="co"># install.packages("dendextend")</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dendextend</span>)

<span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="no">USArrests</span>[<span class="fl">1</span>:<span class="fl">5</span>,])))
<span class="co"># Like: </span>
<span class="co"># dend &lt;- USArrests[1:5,] %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram</span>

<span class="co"># midpoint for all nodes</span>
<span class="fu"><a href="../reference/get_nodes_attr.html">get_nodes_attr</a></span>(<span class="no">dend</span>, <span class="st">"midpoint"</span>)</pre></body></html></div>
<pre><code>## [1] 1.25   NA 1.50 0.50   NA   NA 0.50   NA   NA</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="co"># Perhaps also for the height:</span>
<span class="fu"><a href="../reference/get_nodes_attr.html">get_nodes_attr</a></span>(<span class="no">dend</span>, <span class="st">"height"</span>)</pre></body></html></div>
<pre><code>## [1] 108.85192   0.00000  63.00833  23.19418   0.00000   0.00000  37.17701
## [8]   0.00000   0.00000</code></pre>
<p>To also change an attribute, you can use the various assign functions from the package: <code>assign_values_to_leaves_nodePar</code>, <code>assign_values_to_leaves_edgePar</code>, <code>assign_values_to_nodes_nodePar</code>, <code>assign_values_to_branches_edgePar</code>, <code>remove_branches_edgePar</code>, <code>remove_nodes_nodePar</code></p>
</div>
<div id="how-to-color-the-branches-in-heatmap-2" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-color-the-branches-in-heatmap-2" class="anchor"></a>How to color the branches in heatmap.2?</h3>
<p>Asked (<a href="http://stackoverflow.com/questions/29265536/how-to-color-the-branches-and-tick-labels-in-the-heatmap-2" class="uri">http://stackoverflow.com/questions/29265536/how-to-color-the-branches-and-tick-labels-in-the-heatmap-2</a>?)[here].</p>
<p>Solution: use the <code>color_branches</code> function (or the <code>set</code> function, with the “branches_k_color”, “k”, and “value” parameters).</p>
<p>(Getting the data for this example is from the (<a href="http://stackoverflow.com/questions/29265536/how-to-color-the-branches-and-tick-labels-in-the-heatmap-2" class="uri">http://stackoverflow.com/questions/29265536/how-to-color-the-branches-and-tick-labels-in-the-heatmap-2</a>)[original SO question])</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">test</span> <span class="kw">&lt;-</span> <span class="no">test0</span>
<span class="no">rnames</span> <span class="kw">&lt;-</span> <span class="no">test</span>[,<span class="fl">1</span>]
<span class="no">test</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span>(<span class="no">test</span>[,<span class="fl">2</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">test</span>)]) <span class="co"># to matrix</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">test</span>) <span class="kw">&lt;-</span> <span class="no">rnames</span>
<span class="no">test</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(<span class="no">test</span>, <span class="kw">center</span><span class="kw">=</span><span class="no">T</span>, <span class="kw">scale</span><span class="kw">=</span><span class="no">T</span>) <span class="co"># data standarization</span>
<span class="no">test</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">test</span>) <span class="co"># transpose</span>


<span class="co">## Creating a color palette &amp; color breaks</span>

<span class="no">my_palette</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"forestgreen"</span>, <span class="st">"yellow"</span>, <span class="st">"red"</span>))(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">299</span>)

<span class="no">col_breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">1</span>,-<span class="fl">0.5</span>,<span class="kw">length</span><span class="kw">=</span><span class="fl">100</span>),  <span class="co"># forestgreen</span>
               <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="kw">length</span><span class="kw">=</span><span class="fl">100</span>), <span class="co"># yellow</span>
               <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="kw">length</span><span class="kw">=</span><span class="fl">100</span>))    <span class="co"># red</span>

<span class="co"># distance &amp; hierarchical clustering</span>
<span class="no">distance</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="no">test</span>, <span class="kw">method</span> <span class="kw">=</span><span class="st">"euclidean"</span>)
<span class="no">hcluster</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="no">distance</span>, <span class="kw">method</span> <span class="kw">=</span><span class="st">"ward.D"</span>)


<span class="no">dend1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="no">hcluster</span>)

<span class="co"># Get the dendextend package</span>
<span class="kw">if</span>(!<span class="fu"><a href="https://rdrr.io/r/base/library.html">require</a></span>(<span class="no">dendextend</span>)) <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"dendextend"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dendextend</span>)
<span class="co"># get some colors</span>
<span class="no">cols_branches</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"darkred"</span>, <span class="st">"forestgreen"</span>, <span class="st">"orange"</span>, <span class="st">"blue"</span>)
<span class="co"># Set the colors of 4 branches</span>
<span class="no">dend1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/color_branches.html">color_branches</a></span>(<span class="no">dend1</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="no">cols_branches</span>)
<span class="co"># or with:</span>
<span class="co"># dend1 &lt;- set(dend1, "branches_k_color", k = 4, value = cols_branches)</span>

<span class="co"># Get the colors of the tips of the dendrogram:</span>
<span class="co"># col_labels &lt;- cols_branches[cutree(dend1, k = 4)] # this may need tweaking in various cases - the following is a more general solution.</span>

<span class="no">col_labels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_leaves_branches_col.html">get_leaves_branches_col</a></span>(<span class="no">dend1</span>)
<span class="co"># But due to the way heatmap.2 works - we need to fix it to be in the </span>
<span class="co"># order of the data!   </span>
<span class="no">col_labels</span> <span class="kw">&lt;-</span> <span class="no">col_labels</span>[<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/order.dendrogram.html">order.dendrogram</a></span>(<span class="no">dend1</span>))]

<span class="no">dend1</span>
<span class="co"># plot(dend1)</span>
<span class="co"># a &lt;- heights_per_k.dendrogram(dend1)</span>
<span class="co"># library(dendextendRcpp)</span>
<span class="co"># a2 &lt;- heights_per_k.dendrogram(dend1)</span>
<span class="co"># nleaves(dend1)</span>


<span class="co"># Creating Heat Map</span>
<span class="co"># if(!require(gplots)) install.packages("gplots")</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gplots</span>)
<span class="fu"><a href="https://rdrr.io/pkg/gplots/man/heatmap.2.html">heatmap.2</a></span>(<span class="no">test</span>,
    <span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>( <span class="st">"test"</span>),
        <span class="kw">trace</span><span class="kw">=</span><span class="st">"none"</span>,
        <span class="kw">margins</span> <span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">7</span>),
        <span class="kw">col</span><span class="kw">=</span><span class="no">my_palette</span>,
        <span class="kw">breaks</span><span class="kw">=</span><span class="no">col_breaks</span>,
        <span class="kw">dendrogram</span><span class="kw">=</span><span class="st">"row"</span>,
        <span class="kw">Rowv</span> <span class="kw">=</span> <span class="no">dend1</span>,
        <span class="kw">Colv</span> <span class="kw">=</span> <span class="st">"NA"</span>,
        <span class="kw">key.xlab</span> <span class="kw">=</span> <span class="st">"Concentration (index)"</span>,
        <span class="kw">cexRow</span> <span class="kw">=</span><span class="fl">0.6</span>,
        <span class="kw">cexCol</span> <span class="kw">=</span> <span class="fl">0.8</span>,
        <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
        <span class="kw">RowSideColors</span> <span class="kw">=</span> <span class="no">col_labels</span> <span class="co"># to add nice colored strips     </span>
      <span class="co"># colRow = col_labels # to add nice colored labels - only for qplots 2.17.0 and higher</span>
        )</pre></body></html></div>
</div>
<div id="for-package-developers---how-to-call-imported-calls-from-dendextend-0-18-3" class="section level3">
<h3 class="hasAnchor">
<a href="#for-package-developers---how-to-call-imported-calls-from-dendextend-0-18-3" class="anchor"></a>For package developers - how to call imported calls from dendextend 0.18.3?</h3>
<p>If you are developing a package and you wish to use dendextend as an imported package, that is - without loading it to the search path, you should run:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="kw pkg">dendextend</span><span class="kw ns">::</span><span class="fu"><a href="../reference/assign_dendextend_options.html">assign_dendextend_options</a></span>()
<span class="co"># This populates the dendextend::dendextend_options() space</span></pre></body></html></div>
<p>Before using any of its function (for example: <code><a href="../reference/color_branches.html">dendextend::color_branches</a></code> ). As of dendextend version 1.0.0, this is no longer required.</p>
</div>
<div id="how-to-plot-a-fan-polar-dendrogram-in-r" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-plot-a-fan-polar-dendrogram-in-r" class="anchor"></a>How to plot a fan (Polar) Dendrogram in R?</h3>
<p>Asked (<a href="http://stats.stackexchange.com/questions/4062/how-to-plot-a-fan-polar-dendrogram-in-r" class="uri">http://stats.stackexchange.com/questions/4062/how-to-plot-a-fan-polar-dendrogram-in-r</a>)[here].</p>
<p>Solution: use the <code>circlize_dendrogram</code> function.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="co"># install.packages("dendextend")</span>
<span class="co"># install.packages("circlize")</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dendextend</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">circlize</span>)

<span class="co"># create a dendrogram</span>
<span class="no">hc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="kw pkg">datasets</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/r/datasets/mtcars.html">mtcars</a></span>))
<span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="no">hc</span>)

<span class="co"># modify the dendrogram to have some colors in the branches and labels</span>
<span class="no">dend</span> <span class="kw">&lt;-</span> <span class="no">dend</span> <span class="kw">%&gt;%</span>
   <span class="fu"><a href="../reference/color_branches.html">color_branches</a></span>(<span class="kw">k</span><span class="kw">=</span><span class="fl">4</span>) <span class="kw">%&gt;%</span>
   <span class="no">color_labels</span>

<span class="co"># plot the radial plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">4</span>))
<span class="co"># circlize_dendrogram(dend, dend_track_height = 0.8) </span>
<span class="fu"><a href="../reference/circlize_dendrogram.html">circlize_dendrogram</a></span>(<span class="no">dend</span>, <span class="kw">labels_track_height</span> <span class="kw">=</span> <span class="fl">NA</span>, <span class="kw">dend_track_height</span> <span class="kw">=</span> <span class="fl">.3</span>)</pre></body></html></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-12-1.png" width="750"></p>
</div>
<div id="a-way-to-calculate-lowest-value-of-h-in-cut-that-produces-groupings-of-a-given-minimum-size" class="section level3">
<h3 class="hasAnchor">
<a href="#a-way-to-calculate-lowest-value-of-h-in-cut-that-produces-groupings-of-a-given-minimum-size" class="anchor"></a>A way to calculate lowest value of h in cut that produces groupings of a given minimum size?</h3>
<p>Asked (<a href="http://stackoverflow.com/questions/31124810/r-cut-dendrogram-into-groups-with-minimum-size/" class="uri">http://stackoverflow.com/questions/31124810/r-cut-dendrogram-into-groups-with-minimum-size/</a>)[here].</p>
<p>Solution: use the <code>heights_per_k.dendrogram</code> function.</p>
<p>This feature is available in the dendextend package with the <code>heights_per_k.dendrogram</code> function (which also has a faster C++ implementation when loading the dendextendRcpp function).</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">hc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="no">USArrests</span>[<span class="fl">1</span>:<span class="fl">4</span>,]), <span class="st">"ave"</span>)
<span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="no">hc</span>)
<span class="fu"><a href="../reference/heights_per_k.dendrogram.html">heights_per_k.dendrogram</a></span>(<span class="no">dend</span>)</pre></body></html></div>
<pre><code>##        1        2        3        4 
## 86.47086 68.84745 45.98871 28.36531</code></pre>
<p>As a sidenote, the dendextend package has a <code>cutree.dendrogram</code> S3 method for dendrograms (which works very similarly to <code>cutree</code> for <code>hclust</code> objects).</p>
</div>
<div id="coloring-dendrograms-end-branches-or-leaves-based-on-column-number-of-data-frame-in-r" class="section level3">
<h3 class="hasAnchor">
<a href="#coloring-dendrograms-end-branches-or-leaves-based-on-column-number-of-data-frame-in-r" class="anchor"></a>Coloring dendrogram’s end branches (or leaves) based on column number of data frame in R</h3>
<p>Asked (<a href="http://stackoverflow.com/questions/30062187/coloring-dendrogram-s-end-branches-or-leaves-based-on-column-number-of-data-fr" class="uri">http://stackoverflow.com/questions/30062187/coloring-dendrogram-s-end-branches-or-leaves-based-on-column-number-of-data-fr</a>)[here].</p>
<p>Solution: use the <code>assign_values_to_leaves_edgePar</code> function.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">aa1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">8</span>)
<span class="no">bb1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">7</span>,<span class="fl">11</span>)
<span class="no">aa2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span>)
<span class="no">bb2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">9</span>)
<span class="no">data.main</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">aa1</span>,<span class="no">bb1</span>,<span class="no">aa2</span>,<span class="no">bb2</span>)
<span class="no">d1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">data.main</span>))
<span class="no">hcl1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="no">d1</span>)
<span class="co"># plot(hcl1)</span>

<span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="no">hcl1</span>)
<span class="no">col_aa_red</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"aa"</span>, <span class="fu"><a href="https://rdrr.io/r/base/labels.html">labels</a></span>(<span class="no">dend</span>)), <span class="st">"red"</span>, <span class="st">"blue"</span>)
<span class="no">dend2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/assign_values_to_leaves_edgePar.html">assign_values_to_leaves_edgePar</a></span>(<span class="kw">dend</span><span class="kw">=</span><span class="no">dend</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="no">col_aa_red</span>, <span class="kw">edgePar</span> <span class="kw">=</span> <span class="st">"col"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">dend2</span>)</pre></body></html></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-14-1.png" width="450"></p>
</div>
<div id="color-side-bar-dendrogram-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#color-side-bar-dendrogram-plot" class="anchor"></a>Color side bar dendrogram plot</h3>
<p>Asked (<a href="http://stackoverflow.com/questions/34539746/color-side-bar-dendrogram-plot/" class="uri">http://stackoverflow.com/questions/34539746/color-side-bar-dendrogram-plot/</a>)[here].</p>
<p>Solution: use the <code>color_branches</code> function.</p>
<p>Example using <code>mtcars</code>:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="co">## mtcars example</span>

<span class="co"># Create the dend:</span>
<span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="no">mtcars</span>)))

<span class="co"># Create a vector giving a color for each car to which company it belongs to</span>
<span class="no">car_type</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"Other"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">mtcars</span>)))
<span class="no">is_x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"Merc"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">mtcars</span>))
<span class="no">car_type</span>[<span class="no">is_x</span>] <span class="kw">&lt;-</span> <span class="st">"Mercedes"</span>
<span class="no">is_x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"Mazda"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">mtcars</span>))
<span class="no">car_type</span>[<span class="no">is_x</span>] <span class="kw">&lt;-</span> <span class="st">"Mazda"</span>
<span class="no">is_x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"Toyota"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">mtcars</span>))
<span class="no">car_type</span>[<span class="no">is_x</span>] <span class="kw">&lt;-</span> <span class="st">"Toyota"</span>
<span class="no">car_type</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">car_type</span>)
<span class="no">n_car_types</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">car_type</span>))
<span class="no">cols_4</span> <span class="kw">&lt;-</span> <span class="kw pkg">colorspace</span><span class="kw ns">::</span><span class="fu"><a href="http://colorspace.R-Forge.R-project.org//reference/rainbow_hcl.html">rainbow_hcl</a></span>(<span class="no">n_car_types</span>, <span class="kw">c</span> <span class="kw">=</span> <span class="fl">70</span>, <span class="kw">l</span>  <span class="kw">=</span> <span class="fl">50</span>)
<span class="no">col_car_type</span> <span class="kw">&lt;-</span> <span class="no">cols_4</span>[<span class="no">car_type</span>]

<span class="co"># extra: showing the various clusters cuts </span>
<span class="no">k234</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/cutree-methods.html">cutree</a></span>(<span class="no">dend</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">2</span>:<span class="fl">4</span>)

<span class="co"># color labels by car company:</span>
<span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span>(<span class="no">dend</span>) <span class="kw">&lt;-</span> <span class="no">col_car_type</span>[<span class="fu"><a href="https://rdrr.io/r/stats/order.dendrogram.html">order.dendrogram</a></span>(<span class="no">dend</span>)]
<span class="co"># color branches based on cutting the tree into 4 clusters:</span>
<span class="no">dend</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/color_branches.html">color_branches</a></span>(<span class="no">dend</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">4</span>)

<span class="co">### plots</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">12</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">dend</span>)
<span class="fu"><a href="../reference/colored_bars.html">colored_bars</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">k234</span>[,<span class="fl">3</span>:<span class="fl">1</span>], <span class="no">col_car_type</span>), <span class="no">dend</span>, <span class="kw">rowLabels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"k = "</span>, <span class="fl">4</span>:<span class="fl">2</span>), <span class="st">"Car Type"</span>))</pre></body></html></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-15-1.png" width="450"></p>
<div class="sourceCode"><html><body><pre class="r"><span class="co"># horiz version:</span>
<span class="co"># dend &lt;- sort(dend)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">12</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">dend</span>, <span class="kw">horiz</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="../reference/colored_bars.html">colored_bars</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">k234</span>[,<span class="fl">3</span>:<span class="fl">1</span>], <span class="no">col_car_type</span>), <span class="no">dend</span>, <span class="kw">rowLabels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"k = "</span>, <span class="fl">4</span>:<span class="fl">2</span>), <span class="st">"Car Type"</span>), <span class="kw">horiz</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>, <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">car_type</span>), <span class="kw">fill</span> <span class="kw">=</span> <span class="no">cols_4</span>)</pre></body></html></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-15-2.png" width="450"></p>
</div>
<div id="plot-a-mirror-labels-on-the-left-horizontal-dendrogram" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-a-mirror-labels-on-the-left-horizontal-dendrogram" class="anchor"></a>Plot a “mirror” (labels on the left) horizontal dendrogram</h3>
<p>Asked (<a href="https://github.com/talgalili/dendextend/issues/29" class="uri">https://github.com/talgalili/dendextend/issues/29</a>)[here].</p>
<p>Solution: use the <code>plot_horiz.dendrogram</code> function.</p>
<p>Example using <code>USArrests</code>:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="co"># Create the dend:</span>
<span class="no">hc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="no">USArrests</span>), <span class="st">"ave"</span>)
<span class="no">d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="no">hc</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dendextend</span>)
<span class="no">d</span> <span class="kw">&lt;-</span> <span class="no">d</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/color_branches.html">color_branches</a></span>(<span class="kw">k</span><span class="kw">=</span><span class="fl">3</span>) <span class="kw">%&gt;%</span> <span class="no">color_labels</span>

<span class="co"># horiz normal version</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">7</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">d</span>, <span class="kw">horiz</span>  <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-16-1.png" width="450"></p>
<div class="sourceCode"><html><body><pre class="r"><span class="co"># horiz mirror version</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">7</span>,<span class="fl">1</span>,<span class="fl">1</span>))
<span class="fu"><a href="../reference/plot_horiz.dendrogram.html">plot_horiz.dendrogram</a></span>(<span class="no">d</span>, <span class="kw">side</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-16-2.png" width="450"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Tal Galili, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
